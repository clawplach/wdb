/*! wdb           2014-04-11 */

(function(){var a,b,c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},h=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};e=!0,b=function(){function a(){}return a.prototype.log=function(){var a,b;return e?(b="["+this.constructor.name+"]",a=[b].concat(Array.prototype.slice.call(arguments,0)),console.log.apply(console,a)):void 0},a.prototype.fail=function(){var a,b;return b=this.constructor.name,a=[b].concat(Array.prototype.slice.call(arguments,0)),console.error.apply(console,a)},a}(),c=function(a){function b(a){this.wdb=a,this.url="ws://"+document.location.host+"/websocket/"+_uuid,this.log("Opening new socket",this.url),this.ws=new WebSocket(this.url),this.ws.onclose=this.close.bind(this),this.ws.onopen=this.open.bind(this),this.ws.onerror=this.error.bind(this),this.ws.onmessage=this.message.bind(this)}return g(b,a),b.prototype.time=function(){var a;return a=new Date,""+a.getHours()+":"+a.getMinutes()+":"+(""+a.getSeconds()+"."+a.getMilliseconds())},b.prototype.close=function(a){return this.log("Closed",a)},b.prototype.error=function(a){return this.fail("Error",a)},b.prototype.open=function(a){return this.log("Open",a),this.wdb.opening()},b.prototype.message=function(a){var b,c,d,e;return d=a.data,e=d.indexOf("|"),e>-1?(b=d.substr(0,e),c=JSON.parse(d.substr(e+1))):b=d,this.log(this.time(),"<-",b),b=b.toLowerCase(),b in this.wdb?this.wdb[b.toLowerCase()](c):this.fail("Unknown command",b)},b.prototype.send=function(a,b){var c;return null==b&&(b=null),c=b?""+a+"|"+b:a,this.log(this.time(),"->",c),this.ws.send(c)},b}(b),a=function(a){function b(a){this.wdb=a,CodeMirror.keyMap.wdb={Esc:function(a){return function(){return a.toggle_edition(!1)}}(this),fallthrough:["default"]},CodeMirror.commands.save=function(a){return function(){return a.wdb.ws.send("Save",""+a.cm._fn+"|"+a.cm.getValue())}}(this),this.cm=null}return g(b,a),b.prototype["new"]=function(a,b,c){return null==c&&(c=!1),this.cm=CodeMirror(function(a){return $("#source-editor").prepend(a),$(a).addClass(c?"rw":"ro").addClass("cm")},{value:a,mode:this.get_mode(b),readOnly:!c,theme:"wdb",keyMap:"wdb",gutters:["breakpoints","CodeMirror-linenumbers"],lineNumbers:!0}),this.cm._bg_marks={cls:{},marks:{}},this.cm._rw=c,this.cm._fn=b,this.cm._file=a,this.cm._fun=null,this.cm._last_hl=null,this.cm.on("gutterClick",function(a){return function(b,c){return a.cm=b,a.wdb.toggle_break(":"+(c+1))}}(this)),this.cm.addClass=function(a){return function(b,c){return a.cm.addLineClass(b-1,"background",c),a.cm._bg_marks.cls[b]=a.cm._bg_marks.cls[b]?a.cm._bg_marks.cls[b]+" "+c:c}}(this),this.cm.removeClass=function(a){return function(b,c){return a.cm.removeLineClass(b-1,"background",c),delete a.cm._bg_marks.cls[b]}}(this),this.cm.addMark=function(a){return function(b,c,d){return a.cm._bg_marks.marks[b]=[c,d],a.cm.setGutterMarker(b-1,"breakpoints",$("<div>",{"class":c}).html(d).get(0))}}(this),this.cm.removeMark=function(a){return function(b){return delete a.cm._bg_marks.marks[b],a.cm.setGutterMarker(b-1,"breakpoints",null)}}(this)},b.prototype.toggle_edition=function(a){var b,c,d,e,f,g;c=$.extend({},this.cm._bg_marks.cls),e=$.extend({},this.cm._bg_marks.marks),f=$("#source .CodeMirror-scroll").scrollTop(),$("#source .CodeMirror").remove(),this.cm=this["new"](this.cm._file,this.cm._fn,a);for(d in c)this.cm.addClass(d,c[d]);for(d in e)g=e[d],c=g[0],b=g[1],this.cm.addMark(d,c,b);return $("#source .CodeMirror-scroll").scrollTop(f),this.print({"for":"Toggling edition",result:"Edit mode "+(a?"on":"off")})},b.prototype.select=function(a,b){var c,d,e,f,g,h,i,j,k;if(this.cm){if(this.cm._fn===a.name){if(this.cm._fun!==b["function"])for(e in this.cm._bg_marks.cls)this.cm.removeLineClass(e-1,"background");for(e in this.cm._bg_marks.marks)this.cm.setGutterMarker(e-1,"breakpoints",null);this.cm._last_hl&&(this.cm.removeLineClass(e-1,"background"),this.cm.addLineClass(e-1,"background","footstep"))}else this.cm.setValue(a.file),this.cm._fn=a.name,this.cm._fun=b["function"],this.cm._file=a.file,this.cm._last_hl=null;this.cm._bg_marks.cls={},this.cm._bg_marks.marks={}}else this["new"](a.file,a.name);for(i=a.breaks,f=0,h=i.length;h>f;f++)e=i[f],this.cm.addClass(e,"breakpoint"),this.cm.addMark(e,"breakpoint","●");if(this.cm.addClass(b.lno,"highlighted"),this.cm.addMark(b.lno,"highlighted","➤"),this.cm._fun!==b["function"]&&"<module>"!==b["function"]){for(e=g=j=b.flno,k=b.llno+1;k>=j?k>g:g>k;e=k>=j?++g:--g)this.cm.addClass(e,"ctx"),e===b.flno?this.cm.addClass(e,"ctx-top"):e===b.llno&&this.cm.addClass(e,"ctx-bottom");this.cm._fun=b["function"]}return this.cm._last_hl=b.lno,this.cm.scrollIntoView({line:b.lno,ch:1},1),d=$("#source .CodeMirror-scroll"),c=$("#source .highlighted"),d.scrollTop(c.offset().top-d.offset().top+d.scrollTop()-d.height()/2)},b.prototype.get_mode=function(a){var b;return b=a.split(".").splice(-1)[0],"python"},b}(b),d=function(b){function d(){var b;this.started=!1,this.to_complete=null,this.ws=new c(this),this.cm=new a(this),this.cwd=null,this.backsearch=null,this.cmd_hist=[],this.session_cmd_hist={},this.file_cache={},this.last_cmd=null,this.waited_for_ws=0,this.$state=$(".state"),this.$waiter=$("#waiter"),this.$wdb=$("#wdb"),this.$eval=$("#eval"),this.$source=$("#source"),this.$traceback=$("#traceback"),this.$traceback.on("click",".traceline",this.select_click.bind(this)),this.$title=$("#title");try{this.cmd_hist=JSON.parse(localStorage.cmd_hist)}catch(d){b=d,this.fail(b)}}return g(d,b),d.prototype.opening=function(){return this.started||(this.register_handlers(),this.started=!0),this.start(),this.$waiter.remove(),this.$wdb.show(),this.$eval.autosize()},d.prototype.working=function(){return this.$state.addClass("on")},d.prototype.chilling=function(){return this.$state.removeClass("on")},d.prototype.start=function(){return this.ws.send("Start")},d.prototype.init=function(a){return this.cwd=a.cwd},d.prototype.title=function(a){return this.$title.text(a.title).attr("title",a.title).append($("<small>").text(a.subtitle).attr("title",a.subtitle))},d.prototype.trace=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;for(this.$traceback.empty(),m=a.trace,n=[],k=0,l=m.length;l>k;k++)i=m[k],g=$("<div>").addClass("traceline").attr("id","trace-"+i.level).attr("data-level",i.level),i.current&&g.addClass("real-selected"),c=$("<span>").addClass("tracefile").text(i.file),h=$("<span>").addClass("tracelno").text(i.lno),e=$("<span>").addClass("tracefun").text(i["function"]),d=$("<div>").addClass("tracefilelno").append(c).append(h),f=$("<div>").addClass("tracefunfun").append(e),i.file.indexOf("site-packages")>0&&(j=i.file.split("site-packages").slice(-1)[0],c.text(j),c.prepend($("<span>").addClass("tracestar").text("*").attr({title:i.file}))),0===i.file.indexOf(this.cwd)&&(j=i.file.split(this.cwd).slice(-1)[0],c.text(j),c.prepend($("<span>").addClass("tracestar").text(".").attr({title:i.file}))),b=$("<div>").addClass("tracecode"),this.code(b,i.code),g.append(d),g.append(b),g.append(f),n.push(this.$traceback.prepend(g));return n},d.prototype.select_click=function(a){return this.ws.send("Select",$(a.currentTarget).attr("data-level"))},d.prototype.selectcheck=function(a){return a.name in this.file_cache?(a.file=this.file_cache[a.name],this.select(a)):this.ws.send("File",a.name)},d.prototype.select=function(a){var b;return this.$source=$("#source"),b=a.frame,$("#interpreter").show(),$(".traceline").removeClass("selected"),$("#trace-"+b.level).addClass("selected"),this.$eval.val("").attr("data-index",-1).trigger("autosize.resize"),this.file_cache[a.name]=a.file,this.cm.select(a,b),this.chilling()},d.prototype.ellipsize=function(a){return a.find("span.cm-string").each(function(){var a;return a=$(this).text(),a.length>128?($(this).text(""),$(this).append($('<span class="short close">').text(a.substr(0,128))),$(this).append($('<span class="long">').text(a.substr(128)))):void 0})},d.prototype.code=function(a,b,c,d){var e,f,g,h,i;if(null==c&&(c=[]),null==d&&(d=!1),d)f="<"!==b[0]||">"!==b.slice(-1)?$("<div>",{"class":"out"}).html(b):$(b),a.append(f),f.add(f.find("*")).contents().filter(function(){return 3===this.nodeType&&this.nodeValue.length>0&&!$(this.parentElement).closest("thead").size()}).wrap("<code>").parent().each(function(a){return function(b,d){var e,f,g,h;for(e=$(d),e.addClass("waiting_for_hl").addClass("cm"),g=0,h=c.length;h>g;g++)f=c[g],e.addClass(f);return setTimeout(function(){return CodeMirror.runMode(e.text(),"python",e.get(0)),e.removeClass("waiting_for_hl"),a.ellipsize(e)},50)}}(this));else{for(e=$("<code>",{"class":"cm"}),h=0,i=c.length;i>h;h++)g=c[h],e.addClass(g);a.append(e),CodeMirror.runMode(b,"python",e.get(0)),this.ellipsize(e)}return e},d.prototype.historize=function(a){var b,c;b=$(".selected .tracefile").text(),b in this.session_cmd_hist||(this.session_cmd_hist[b]=[]);for(;-1!==(c=this.cmd_hist.indexOf(a));)this.cmd_hist.splice(c,1);return this.cmd_hist.unshift(a),this.session_cmd_hist[b].unshift(a),localStorage&&(localStorage.cmd_hist=JSON.stringify(this.cmd_hist))},d.prototype.execute=function(a){var b,c,d,e;if(a=a.trim(),this.historize(a),b=function(){var a;return this.ws.send.apply(this,arguments),a=arguments},0!==a.indexOf("."))return 0===a.indexOf("?")?(b("Dump",a.slice(1).trim()),this.working(),void this.suggest_stop()):""===a&&last_cmd?void b.apply(this,last_cmd):a?(this.ws.send("Eval",a),this.$eval.val(this.$eval.val()+"…").trigger("autosize.resize").prop("disabled",!0),this.working()):void 0;switch(e=a.indexOf(" "),e>-1?(d=a.substr(1,e-1),c=a.substr(e+1)):(d=a.substr(1),c=""),d){case"b":this.toggle_break(c);break;case"c":b("Continue");break;case"d":b("Dump",c);break;case"e":this.cm.toggle_edition(!this.cm.cm._rw);break;case"g":this.cls();break;case"h":this.print_help();break;case"j":b("Jump",c);break;case"l":b("Breakpoints");break;case"n":b("Next");break;case"q":b("Quit");break;case"r":b("Return");break;case"s":b("Step");break;case"i":b("Display",c);break;case"t":this.toggle_break(c,!0);break;case"u":b("Until");break;case"w":b("Watch",c);break;case"z":b("Unbreak",c);break;case"f":this.print_hist(this.session_cmd_hist[$(".selected .tracefile").text()])}},d.prototype.cls=function(){return $("#completions").height($("#interpreter").height()-$("#prompt").innerHeight()),this.termscroll(),this.$eval.val("").trigger("autosize.resize")},d.prototype.print_hist=function(a){return this.print({"for":"History",result:a.slice(0).reverse().filter(function(a){return 0!==a.indexOf(".")}).join("\n")})},d.prototype.print_help=function(){return this.print({"for":"Supported commands",result:'.s or [Ctrl] + [↓] or [F11]    :Step into\n.n or [Ctrl] + [→] or [F10]    :Step over (Next)\n.r or [Ctrl] + [↑] or [F9]     :Step out (Return)\n.c or [Ctrl] + [←] or [F8]     :Continue\n.u or [F7]                     :Until (Next over loops)\n.j lineno                        :Jump to lineno (Must be at bottom frame and in the same function)\n.b arg                         :Set a session breakpoint  see below for what arg can be*\n.t arg                         :Set a temporary breakpoint, arg follow the same syntax as .b\n.z arg                         :Delete existing breakpoint\n.l                             :List active breakpoints\n.f                             :Echo all typed commands in the current debugging session\n.d expression                    :Dump the result of expression in a table\n.w expression                    :Watch expression in curent file (Click on the name to remove)\n.q                             :Quit\n.h                             :Get some help\n.e                             :Toggle file edition mode\n.g                             :Clear prompt\n.i [mime/type;]expression        :Display the result in an embed, mime type defaults to "text/html"\niterable!sthg                    :If cutter is installed, executes cut(iterable).sthg\nexpr >! file                     :Write the result of expr in file\n!< file                        :Eval the content of file\n[Enter]                        :Eval the current selected text in page, useful to eval code in the source\n\n* arg is using the following syntax:\n    [file/module][:lineno][#function][,condition]\nwhich means:\n    - [file]                    :Break if any line of `file` is executed\n    - [file]:lineno             :Break on `file` at `lineno`\n    - [file][:lineno],condition :Break on `file` at `lineno` if `condition` is True (ie: i == 10)\n    - [file]#function             :Break when inside `function` function\nFile is always current file by default and you can also specify a module like `logging.config`.'})},d.prototype.termscroll=function(){return $("#interpreter").stop(!0).animate({scrollTop:$("#scrollback").height()},1e3)},d.prototype.print=function(a){var b;return this.suggest_stop(),b=this.$eval.val(),this.code($("#scrollback"),a["for"],["prompted"]),this.code($("#scrollback"),a.result,[],!0),this.$eval.val("").prop("disabled",!1).attr("data-index",-1).trigger("autosize.resize").focus(),$("#completions").attr("style",""),this.termscroll(),this.chilling()},d.prototype.echo=function(a){return this.code($("#scrollback"),a["for"],["prompted"]),this.code($("#scrollback"),a.val||"",[],!0),this.termscroll(),this.chilling()},d.prototype.dump=function(a){var b,c,d,e,f,g,h,i,j;this.code($("#scrollback"),a["for"],["prompted"]),c=$("<div>"),f=$("<table>",{"class":"object"}).appendTo(c),f.append($("<thead>",{"class":"toggle hidden"}).append($("<tr>").append($("<td>",{"class":"core",colspan:2}).text("Core Members")))),d=$("<tbody>",{"class":"core hidden"}).appendTo(f),f.append($("<thead>",{"class":"toggle hidden"}).append($("<tr>").append($("<td>",{"class":"method",colspan:2}).text("Methods")))),e=$("<tbody>",{"class":"method hidden"}).appendTo(f),f.append($("<thead>",{"class":"toggle shown"}).append($("<tr>").append($("<td>",{"class":"attr",colspan:2}).text("Attributes")))),b=$("<tbody>",{"class":"attr shown"}).appendTo(f),j=a.val;for(h in j)i=j[h],g=b,0===h.indexOf("__")&&-1!==h.indexOf("__",h.length-2)?g=d:-1!==i.type.indexOf("method")&&(g=e),g.append($("<tr>").append($("<td>").text(h)).append($("<td>").html(i.val)));return this.code($("#scrollback"),c.html(),[],!0),this.termscroll(),this.$eval.val("").prop("disabled",!1).trigger("autosize.resize").focus(),this.chilling()},d.prototype.breakset=function(a){return a.lno&&(this.cm.cm.removeClass(a.lno,"ask-breakpoint"),this.cm.cm.addClass(a.lno,"breakpoint"),this.cm.cm.addMark(a.lno,"breakpoint",a.temporary?"○":"●"),a.cond&&$line.attr("title","On ["+a.cond+"]")),(0===this.$eval.val().indexOf(".b ")||0===this.$eval.val().indexOf(".t "))&&this.$eval.val("").prop("disabled",!1).trigger("autosize.resize").focus(),this.chilling()},d.prototype.breakunset=function(a){return this.cm.cm.removeClass(a.lno,"ask-breakpoint"),0===this.$eval.val().indexOf(".b ")&&this.$eval.val("").prop("disabled",!1).trigger("autosize.resize").focus(),this.chilling()},d.prototype.toggle_break=function(a,b){var c,d,e;return d=b?"TBreak":"Break",e=0/0,a.indexOf(":")>-1&&(e=a.split(":")[1],e.indexOf(",")>-1&&(e=a.split(",")[0]),e.indexOf("#")>-1&&(e=a.split("#")[0]),e=parseInt(e)),isNaN(e)?void this.ws.send(d,a):(c=this.cm.cm.lineInfo(e-1).bgClass||"",c.split(" ").indexOf("breakpoint")>-1?(this.cm.cm.removeMark(e),this.cm.cm.removeClass(e,"breakpoint"),this.cm.cm.addClass(e,"ask-breakpoint"),this.ws.send("Unbreak",":"+e)):(this.cm.addClass(e,"ask-breakpoint"),this.ws.send(d,a)))},d.prototype.format_fun=function(a){var b,c,d,e,f,g,h;for(e=[$("<span>",{"class":"fun_name",title:a.module}).text(a.call_name),$("<span>",{"class":"fun_punct"}).text("(")],h=a.params,c=f=0,g=h.length;g>f;c=++f)d=h[c],b="fun_param",(c===a.index||c===a.params.length-1&&a.index>c)&&(b="fun_param active"),e.push($("<span>",{"class":b}).text(d)),c!==a.params.length-1&&e.push($("<span>",{"class":"fun_punct"}).text(", "));return e.push($("<span>",{"class":"fun_punct"}).text(")")),e},d.prototype.suggest=function(a){var b,c,d,e,f,g,i,j,k,l,m,n,o,p,q,r,s,t;if(a){for(d=$("#completions"),c=$("#completions table").empty(),c.append($('<thead><tr><th id="comp-desc" colspan="5">')),k=d.height(),g=[],r=a.params,n=0,p=r.length;p>n;n++)m=r[n],$("#comp-desc").append(format_fun(m));for(a.completions.length&&(e=$("<tbody>"),i=a.completions[0].base.length,this.$eval.data({root:this.$eval.val().substr(0,this.$eval.val().length-i)})),s=a.completions,l=o=0,q=s.length;q>o;l=++o)j=s[l],t=j.base+j.complete,h.call(g,t)>=0||(g.push(j.base+j.complete),l%5===0&&e.append(b=$("<tr>")),b.append(f=$("<td>").attr("title",j.description).append($("<span>").addClass("base").text(j.base)).append($("<span>").addClass("completion").text(j.complete))),j.complete||(f.addClass("active complete"),$("#comp-desc").html(f.attr("title"))));c.append(e),d.height(Math.max(k,c.height())),this.termscroll()}return this.to_complete?(this.ws.send("Complete",this.to_complete),this.to_complete=!1):this.to_complete=null},d.prototype.suggest_stop=function(){return $("#completions table").empty()},d.prototype.watched=function(a){var b,c,d,e,g,h;e=$("#watchers");for(h in a)f.call(a,h)&&(g=a[h],d=e.find(".watching").filter(function(a){return $(a).attr("data-expr")===h}),d.size()?(d.find(".value code").remove(),this.code(d.find(".value"),g.toString(),[],!0)):(b=$("<code>",{"class":"name"}),c=$("<div>",{"class":"value"}),e.append(d=$("<div>",{"class":"watching"}).attr("data-expr",h).append(b.text(h),$("<code>").text(": "),c)),this.code(c,g.toString(),[],!0)),d.addClass("updated"));return e.find(".watching:not(.updated)").remove(),e.find(".watching").removeClass("updated")},d.prototype.ack=function(){return this.$eval.val("").trigger("autosize.resize")},d.prototype.display=function(a){var b,c;return this.suggest_stop(),c=this.$eval.val(),this.code($("#scrollback"),a["for"],["prompted"]),b=a.type.indexOf("image")>=0?$("<img>"):a.type.indexOf("audio")>=0?$("<audio>",{controls:"controls",autoplay:"autoplay"}):a.type.indexOf("video")>=0||a.type.indexOf("/ogg")>=0?$("<video>",{controls:"controls",autoplay:"autoplay"}):$("<iframe>"),b.addClass("display"),b.attr("src","data:"+a.type+";charset=UTF-8;base64,"+a.val),$("#scrollback").append(b),this.$eval.val("").prop("disabled",!1).attr("data-index",-1).trigger("autosize.resize").focus(),$("#completions").attr("style",""),this.termscroll(),this.chilling()},d.prototype.searchback=function(){var a,b,c,d,e,f,g;for(this.suggest_stop(),b=this.backsearch,d=this.$eval.val(),g=this.cmd_hist,e=0,f=g.length;f>e;e++)if(a=g[e],c=new RegExp("("+d+")","gi"),c.test(a)&&(b--,0===b))return void $("#backsearch").html(a.replace(c,'<span class="backsearched">$1</span>'));return 1===this.backsearch?void this.searchback_stop():this.backsearch=Math.max(this.backsearch-1,1)},d.prototype.searchback_stop=function(a){return a&&this.$eval.val($("#backsearch").text()).trigger("autosize.resize"),$("#backsearch").html(""),this.backsearch=null},d.prototype.die=function(){return $("#source,#traceback").remove(),$("h1").html("Dead<small>Program has exited</small>"),this.ws.ws.close(),setTimeout(function(){return window.close()},10)},d.prototype.register_handlers=function(){return $("body,html").on("keydown",function(a){return function(b){var c;if(null!=(c=a.cm.cm)?c._rw:void 0)return!0;if(b.ctrlKey&&37===b.keyCode||119===b.keyCode)a.ws.send("Continue");else if(b.ctrlKey&&38===b.keyCode||120===b.keyCode)a.ws.send("Return");else if(b.ctrlKey&&39===b.keyCode||121===b.keyCode)a.ws.send("Next");else if(b.ctrlKey&&40===b.keyCode||122===b.keyCode)a.ws.send("Step");else{if(118!==b.keyCode)return!0;a.ws.send("Until")}return a.working(),!1}}(this)),this.$eval.on("keydown",function(a){return function(b){var c,d,e,f,g,h,i,j,k,l;if(b.altKey&&82===b.keyCode&&a.backsearch)return a.backsearch=Math.max(a.backsearch-1,1),a.searchback(),!1;if(b.ctrlKey){if(82===b.keyCode)return null===a.backsearch?a.backsearch=1:b.shiftKey?a.backsearch=Math.max(a.backsearch-1,1):a.backsearch++,a.searchback(),!1;if(67===b.keyCode)a.searchback_stop();else{if(68!==b.keyCode)return void b.stopPropagation();a.ws.send("Quit")}}if(13===b.keyCode){if(a.backsearch)return a.searchback_stop(!0),!1;if($("#completions table td.active").length&&!$("#completions table td.complete").length)return a.suggest_stop(),!1;if(!b.shiftKey)return a.execute(a.$eval.val()),!1}else{if(27===b.keyCode)return a.suggest_stop(),a.searchback_stop(),!1;if(9===b.keyCode)return b.shiftKey?(l=a.$eval.get(0),j=l.selectionStart,g=l.selectionEnd,j||"0"===j?a.$eval.val(a.$eval.val().substring(0,j)+"  "+a.$eval.val().substring(g,a.$eval.val().length)).trigger("autosize.resize"):a.$eval.val(a.$eval.val()+"  ").trigger("autosize.resize"),!1):a.backsearch?!1:(d=$("#completions table td"),c=d.filter(".active"),d.length&&(c.length?(i=d.index(c),i===d.length-1?i=0:i++,c.removeClass("active complete"),c=d.eq(i).addClass("active")):c=d.first().addClass("active"),e=c.find(".base").text(),f=c.find(".completion").text(),a.$eval.val($eval.data().root+e+f).trigger("autosize.resize"),$("#comp-desc").text(c.attr("title")),a.termscroll()),!1);if(38===b.keyCode){if(a.$eval=$(a),h=$(".selected .tracefile").text(),!b.shiftKey&&(i=parseInt($eval.attr("data-index"))+1,i>=0&&i<a.cmd_hist.length))return k=a.cmd_hist[i],0===i&&a.$eval.attr("data-current",a.$eval.val()),a.$eval.val(k).attr("data-index",i).trigger("autosize.resize"),a.suggest_stop(),a.termscroll(),!1}else if(40===b.keyCode&&(h=$(".selected .tracefile").text(),!b.shiftKey&&(i=parseInt($eval.attr("data-index"))-1,i>=-1&&i<a.cmd_hist.length)))return k=-1===i?a.$eval.attr("data-current"):a.cmd_hist[i],a.$eval.val(k).attr("data-index",i).trigger("autosize.resize"),a.suggest_stop(),a.termscroll(),!1}}}(this)),$("#scrollback, #watchers").on("click","a.inspect",function(a){return function(){return a.ws.send("Inspect",$(a).attr("href")),a.working(),!1}}(this)).on("click",".short.close",function(){return $(this).addClass("open").removeClass("close").next(".long").show("fast")}).on("click",".long,.short.open",function(){var a;return a=$(this).hasClass("long")?$(this):$(this).next(".long"),a.hide("fast").prev(".short").removeClass("open").addClass("close")}).on("click",".toggle",function(){return $(this).add($(this).next()).toggleClass("hidden","shown")}),$("#watchers").on("click",".watching .name",function(a){return function(b){return a.ws.send("Unwatch",$(b.currentTarget)).closest(".watching").attr("data-expr"),a.working()}}(this)),$("#source").on("mouseup","span",function(a){return function(b){var c;return 2===b.which?(c=$(b.currentTarget).text().trim(),a.historize(c),a.ws.send("Dump",c),a.working()):void 0}}(this)),$(document).on("keydown",function(a){return function(b){var c;return 13===b.keyCode&&(c=a.cm.cm.getSelection().trim())?(a.historize(c),a.ws.send("Eval",c),!1):void 0}}(this)),this.$eval.on("input",function(a){return function(b){var c,d,e;return e=$(b.currentTarget).val(),a.backsearch?void(e?(a.backsearch=1,a.searchback()):a.searchback_stop()):(d=a.session_cmd_hist[$(".selected .tracefile").text()]||[],e&&"."!==e[0]?(c=d.slice(0).reverse().filter(function(a){return 0!==a.indexOf(".")}).join("\n")+"\n"+e,null===a.to_complete?(a.ws.send("Complete",c),a.to_complete=!1):a.to_complete=c):a.suggest_stop())}}(this)).on("blur",function(a){return function(){return a.searchback_stop()}}(this))},d}(b),$(function(a){return function(){return setTimeout(function(){return $("#deactivate").click(function(){return window.wdb.ws.send("Disable"),!1})},250),a.wdb=new d}}(this))}).call(this);
//# sourceMappingURL=wdb.min.map